<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1; minimum-scale=1; user-scalable=no;"> <meta content="[Infra] Kubernetes Canary ë°°í¬ ì „ëµ ì‹¤ìŠµ" name="description"> <meta name="keywords" content="son,blog,infra,docker,minikube,kubernetes,grafana,canary"> <meta name="author" content="son"> <meta name="baseurl" content=""> <title> son | [Infra] Kubernetes Canary ë°°í¬ ì „ëµ ì‹¤ìŠµ </title> <!-- favicon --> <link rel="shortcut icon" href="/static/assets/img/favicon.ico"> <!-- Main CSS --> <link href="/static/assets/app-20200311.min.css" rel="stylesheet"> <link href="/static/css/custom.css" rel="stylesheet"> <!-- Main Scripts --> <script src="/static/assets/app-20200311.min.js"></script> <script src="/static/assets/blog-20200311.min.js"></script> <!-- Google AdSense --> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script> (adsbygoogle = window.adsbygoogle || []).push({ google_ad_client: "ca-pub-6196184620200311", enable_page_level_ads: true }); </script> </head> <body id="page-top" class="landing-page"> <div class="search-tool" style="position: fixed; top: 0px ; bottom: 0px; left: 0px; right: 0px; opacity: 0.95; background-color: #111111; z-index: 9999; display: none;"> <input type="text" class="form-control search-content" id="search-content" style="position: fixed; top: 60px" placeholder="Search Blog"> <div style="position: fixed; top: 16px; right: 16px; z-index: 9999;"> <img src="/static/assets/img/search/cb-close.png" id="close-btn"/> </div> </div> <div style="position: fixed; right: 16px; bottom: 20px; z-index: 9999;"> <img src="/static/assets/img/search/cb-search.png" id="search-btn" title="Double click Ctrl"/> </div> <div class="navbar-wrapper"> <nav class="navbar navbar-default navbar-fixed-top" role="navigation"> <div class="container"> <div class="navbar-header page-scroll"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/">son</a> </div> <div id="navbar" class="navbar-collapse collapse"> <ul class="nav navbar-nav navbar-right"> <li><a class="page-scroll" href="blog/"></a></li> <li> <a class="page-scroll" href="/blog/">All</a></li> <li> <a class="page-scroll" href="/project/">Project</a></li> <li> <a class="page-scroll" href="/research/">Research</a></li> <li> <a class="page-scroll" href="/troubleshooting/">Troubleshooting</a></li> <li> <a class="page-scroll" href="/infra/">Infra</a></li> <li> <a class="page-scroll" href="/data/">Data</a></li> <li> <a class="page-scroll" href="/anything/">Anything</a></li> </ul> </div> </div> </nav> </div> <div id="inSlider" class="carousel carousel-fade" data-ride="carousel"> <ol class="carousel-indicators"> <li data-target="#inSlider" data-slide-to="0" class="active"></li> <li data-target="#inSlider" data-slide-to="1"></li> <li data-target="#inSlider" data-slide-to="2"></li> </ol> <div class="carousel-inner" role="listbox"> <div class="item active"> <div class="container"> <div class="carousel-caption"> </div> <div class="carousel-image wow zoomIn"> <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> --> </div> </div> <!-- Set background for slide in css --> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_one.jpg);" title="han-gi's blog"> </div> </div> <div class="item"> <div class="container"> <div class="carousel-caption"> </div> <div class="carousel-image wow zoomIn"> <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> --> </div> </div> <!-- Set background for slide in css --> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_two.jpg);" title="han-gi's blog"></div> </div> <div class="item"> <div class="container"> <div class="carousel-caption"> </div> <div class="carousel-image wow zoomIn"> <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> --> </div> </div> <!-- Set background for slide in css --> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_three.jpg);" title="han-gi's blog"></div> </div> </div> <a class="left carousel-control" href="#inSlider" role="button" data-slide="prev"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> <span class="sr-only">Previous</span> </a> <a class="right carousel-control" href="#inSlider" role="button" data-slide="next"> <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span> <span class="sr-only">Next</span> </a> </div> <div class="wrapper wrapper-content animated fadeInRight article"> <div class="row"> <div class="col-lg-10 col-lg-offset-1"> <div class="ibox"> <div class="ibox-content"> <div class="pull-right"> <a class="btn btn-white btn-xs" href="/infra">Infra</a> </div> <div class="text-center article-title"> <span class="text-muted"><i class="fa fa-clock-o"></i> 24 Oct 2022</span> <h1> [Infra] Kubernetes Canary ë°°í¬ ì „ëµ ì‹¤ìŠµ </h1> </div> <div class="ksJIXb"> <div class="ikVqUi"> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#ê°œìš”">ê°œìš”</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#1-ë‚´-ì§ˆë¬¸ì—ëŠ”-ì™œ-ë‹µë³€ì—-ë‹¬ë¦¬ì§€-ì•Šì„ê¹Œ---ê°œë°œìê°€-ì§ˆë¬¸í•˜ëŠ”-ë²•">1. ë‚´ ì§ˆë¬¸ì—ëŠ” ì™œ ë‹µë³€ì— ë‹¬ë¦¬ì§€ ì•Šì„ê¹Œ? - ê°œë°œìê°€ ì§ˆë¬¸í•˜ëŠ” ë²•</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#1-ì§ˆë¬¸ì„-í•˜ê¸°-ì „ì—-í•´ì•¼-í• -ê²ƒë“¤">1) ì§ˆë¬¸ì„ í•˜ê¸° ì „ì— í•´ì•¼ í•  ê²ƒë“¤</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#2-ì´ì œ-ê²€ìƒ‰í•´ë³´ì">2) ì´ì œ ê²€ìƒ‰í•´ë³´ì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#3-ê·¸ë˜ë„-í•´ê²°ì´-ì•ˆ-ë˜ì—ˆìœ¼ë©´-ì§ˆë¬¸ì„-í•˜ì">3) ê·¸ë˜ë„ í•´ê²°ì´ ì•ˆ ë˜ì—ˆìœ¼ë©´ ì§ˆë¬¸ì„ í•˜ì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#2-ì§ˆë¬¸ì„-ì˜í•˜ëŠ”-ê°œë°œì">2. ì§ˆë¬¸ì„ ì˜í•˜ëŠ” ê°œë°œì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#1-ì¶©ë¶„í•œ-êµ¬ê¸€ë§ì„-ìš°ì„ -ì„ í–‰í•˜ì">1) ì¶©ë¶„í•œ êµ¬ê¸€ë§ì„ ìš°ì„  ì„ í–‰í•˜ì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#2-ë™ë£Œì˜-ì‹œê°„ì„-ë‚­ë¹„í•˜ì§€-ë§ìì§ˆë¬¸-ì •ë¦¬í•´ì•¼-í•˜ëŠ”-ì´ìœ ">2) ë™ë£Œì˜ ì‹œê°„ì„ ë‚­ë¹„í•˜ì§€ ë§ì(ì§ˆë¬¸ ì •ë¦¬í•´ì•¼ í•˜ëŠ” ì´ìœ )</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#3-ì§ˆë¬¸-ì •ë¦¬í•˜ê¸°">3) ì§ˆë¬¸ ì •ë¦¬í•˜ê¸°</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#4-í•œ-ê±¸ìŒ-ë”-ë‚˜ì•„ê°€ì„œ">4) í•œ ê±¸ìŒ ë” ë‚˜ì•„ê°€ì„œ!</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#-íšŒê³ ">ğŸ¹ íšŒê³ </a></div> </div> </div> <p>ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” Kubernetesì˜ ì—¬ëŸ¬ ë°°í¬ ì „ëµ ì¤‘ Canaryì— ëŒ€í•´ ì•Œì•„ë³´ê³  ì‹¤ìŠµí•´ë³¼ ê²ƒì´ë‹¤. ì‹¤ìŠµ ì§„í–‰ì€ <a href="&quot;https://github.com/ContainerSolutions/k8s-deployment-strategies&quot;">í•´ë‹¹ ê¹ƒí—ˆë¸Œ ë‚´ìš©</a>ì„ ì°¸ê³ í•˜ì˜€ë‹¤.</p> <hr /> <h2 id="ëª©ì°¨">ëª©ì°¨</h2> <p><a href="#list1">1. Canary ë°°í¬</a></p> <p><a href="#list1_1">Â Â  1.1. Canaryë€?</a></p> <p><a href="#list1_2">Â Â  1.2. Canary ì‹¤ìŠµ</a></p> <p><a href="#list1_3">Â Â  1.3. Grafana dashboard í™•ì¸</a></p> <hr /> <h2 id="1-canary-ë°°í¬-"><span style="color:purple"><strong>1. Canary ë°°í¬</strong></span> <a name="list1"></a></h2> <p><br /></p> <h3 id="11-canaryë€-">1.1. Canaryë€? <a name="list1_1"></a></h3> <p>Canary ë°°í¬ëŠ” íŠ¹ì • ì„œë²„ë‚˜ ì†Œìˆ˜ì˜ ìœ ì €ë“¤ì—ê²Œë§Œ ìƒˆë¡œìš´ ë²„ì „ì„ ë°°í¬í•˜ì—¬ í…ŒìŠ¤íŠ¸í•˜ë©´ì„œ ì¶”í›„ ì•ˆì „í•˜ë‹¤ëŠ” íŒë‹¨ì´ ë˜ë©´ ëª¨ë“  ì„œë²„ë“¤ì— ìƒˆë¡œìš´ ë²„ì „ì„ ë°°í¬í•˜ëŠ” ë°©ì‹ì´ë‹¤. ë°°í¬ ë°©ì‹ì„ ê·¸ë¦¼ìœ¼ë¡œ ì‚´í´ë³´ìë©´ ë‹¤ìŒ [ê·¸ë¦¼ 1]ê³¼ ê°™ë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/infra/canary1.png" alt="canary" width="100%" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 1] Canary ë°°í¬ ê³¼ì •</td> </tr> </tbody> </table> <p><br /></p> <p>ì´ ê¸°ë²•ì€ Blue/Green ë°°í¬ ë°©ì‹ê³¼ ìœ ì‚¬í•˜ê²Œ ë¼ë²¨ì„ ì´ìš©í•˜ê³ , A/B í…ŒìŠ¤íŠ¸ ë°©ì‹ê³¼ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì— ìœ ìš©í•˜ë‹¤ê³  í•œë‹¤.</p> <p><br /></p> <h3 id="12-canary-ì‹¤ìŠµ-">1.2. Canary ì‹¤ìŠµ <a name="list1_2"></a></h3> <p>ì‹¤ìŠµì€ ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ ì§„í–‰í–ˆë˜ blue-green/single-service í´ë”ì—ì„œ canary/native í´ë”ë¡œ ì´ë™í•˜ì—¬ ì§„í–‰í•œë‹¤.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  son@son-localhost ~/k8s-deployment-strategies/blue-green/single-service <span class="nv">$ </span><span class="nb">cd</span> ../../canary/native
  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span><span class="nb">cat </span>app-v1.yaml
  apiVersion: v1
  kind: Service
  metadata:
    name: my-app
    labels:
      app: my-app
  spec:
    <span class="nb">type</span>: NodePort
    ports:
    - name: http
      port: 80
      targetPort: http
    selector:
      app: my-app
  <span class="nt">---</span>
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: my-app-v1
    labels:
      app: my-app
  spec:
    replicas: 10
    selector:
      matchLabels:
        app: my-app
        version: v1.0.0
    template:
      metadata:
        labels:
          app: my-app
          version: v1.0.0
        annotations:
          prometheus.io/scrape: <span class="s2">"true"</span>
          prometheus.io/port: <span class="s2">"9101"</span>
      spec:
        containers:
        - name: my-app
          image: crisis513/strategies-test
          ports:
          - name: http
            containerPort: 8080
          - name: probe
            containerPort: 8086
          <span class="nb">env</span>:
          - name: VERSION
            value: v1.0.0
          livenessProbe:
            httpGet:
              path: /live
              port: probe
            initialDelaySeconds: 5
            periodSeconds: 5
          readinessProbe:
            httpGet:
              path: /ready
              port: probe
            periodSeconds: 5
  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span><span class="nb">cat </span>app-v2.yaml
  apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: my-app-v2
    labels:
      app: my-app
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: my-app
        version: v2.0.0
    template:
      metadata:
        labels:
          app: my-app
          version: v2.0.0
        annotations:
          prometheus.io/scrape: <span class="s2">"true"</span>
          prometheus.io/port: <span class="s2">"9101"</span>
      spec:
        containers:
        - name: my-app
          image: crisis513/strategies-test
          ports:
          - name: http
            containerPort: 8080
          - name: probe
            containerPort: 8086
          <span class="nb">env</span>:
          - name: VERSION
            value: v2.0.0
          livenessProbe:
            httpGet:
              path: /live
              port: probe
            initialDelaySeconds: 5
            periodSeconds: 5
          readinessProbe:
            httpGet:
              path: /ready
              port: probe
            periodSeconds: 5
</code></pre></div></div> <p>ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ì‚´í´ë³´ë©´ Blue/Greenê³¼ í¬ê²Œ ë‹¤ë¥¼ ê²ƒì´ ì—†ë‹¤. ë‹¤ë¥¸ ì ì€ replicasì˜ ê°¯ìˆ˜ ì°¨ì´ì´ë‹¤. app-v1.yamlì—ì„œëŠ” replicasê°€ 10ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆê³ , app-v2.yamlì—ëŠ” 1ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p> <p>ë¨¼ì € app-v1.yamlì„ ë°°í¬í•´ë³´ì.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span>k apply <span class="nt">-f</span> app-v1.yaml
  service/my-app created
  deployment.apps/my-app-v1 created

  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span>k get all
  NAME                            READY   STATUS    RESTARTS   AGE
  pod/my-app-v1-9b99b584b-5kc4w   1/1     Running   0          114s
  pod/my-app-v1-9b99b584b-5ksm4   1/1     Running   0          113s
  pod/my-app-v1-9b99b584b-8gdzk   1/1     Running   0          113s
  pod/my-app-v1-9b99b584b-bxlsx   1/1     Running   0          113s
  pod/my-app-v1-9b99b584b-fvmwf   1/1     Running   0          114s
  pod/my-app-v1-9b99b584b-ng5jn   1/1     Running   0          114s
  pod/my-app-v1-9b99b584b-qqm2f   1/1     Running   0          113s
  pod/my-app-v1-9b99b584b-sqhsf   1/1     Running   0          113s
  pod/my-app-v1-9b99b584b-wlz4n   1/1     Running   0          113s
  pod/my-app-v1-9b99b584b-xxkd5   1/1     Running   0          113s

  NAME                 TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>        AGE
  service/kubernetes   ClusterIP   10.96.0.1      &lt;none&gt;        443/TCP        15d
  service/my-app       NodePort    10.103.42.11   &lt;none&gt;        80:32631/TCP   117s

  NAME                        READY   UP-TO-DATE   AVAILABLE   AGE
  deployment.apps/my-app-v1   10/10   10           10          116s

  NAME                                  DESIRED   CURRENT   READY   AGE
  replicaset.apps/my-app-v1-9b99b584b   10        10        10      115s
</code></pre></div></div> <p>ì„œë¹„ìŠ¤ê°€ ì˜¬ë¼ê°€ê³  pod 10ê°œê°€ ì •ìƒì ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œë‹¤ë©´ ì´ì „ í¬ìŠ¤íŒ…ì˜ ë°°í¬ ì „ëµë“¤ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ë©”íŠ¸ë¦­ì„ ìƒì„±í•´ë‚´ê¸° ìœ„í•´ í•´ë‹¹ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ì§€ì†ì ì¸ ìš”ì²­ì„ ë³´ë‚´ë³´ë„ë¡ í•˜ê² ë‹¤.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span><span class="k">while </span><span class="nb">sleep </span>0.1<span class="p">;</span> <span class="k">do </span>curl <span class="nt">-s</span> <span class="nt">-o</span> /dev/null <span class="s2">"http://192.168.49.2:32631"</span><span class="p">;</span> <span class="k">done</span>
</code></pre></div></div> <p>ë§ˆì°¬ê°€ì§€ë¡œ ìš”ì²­ì€ ê³„ì† ë³´ë‚´ë„ë¡ ë‘ê³  ì•½ê°„ì˜ ì‹œê°„ì´ ì§€ë‚˜ê³ ë‚˜ì„œ ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì—´ì–´ app-v2.yamlì„ ë°°í¬í•  ê²ƒì´ë‹¤. ë°°í¬ë¥¼ í•˜ê³ ë‚˜ë©´ my-app-v2 podê°€ í•˜ë‚˜ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— my-app-v1ì˜ replicasë¥¼ í•˜ë‚˜ ì¤„ì¸ 9ê°œë¡œ ì„¤ì •í•  ê²ƒì´ë‹¤.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span>k apply <span class="nt">-f</span> app-v2.yaml
  deployment.apps/my-app-v2 created
  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span>k scale <span class="nt">--replicas</span><span class="o">=</span>9 deploy my-app-v1
  deployment.apps/my-app-v1 scaled
</code></pre></div></div> <p>ì—¬ê¸°ê¹Œì§€ ì§„í–‰ëë‹¤ë©´ í˜„ì¬ 9ê°œì˜ my-app-v1 podê°€ 9ê°œ, my-app-v2 podê°€ 1ê°œë¡œ Running ì¤‘ì¼ ê²ƒì´ë‹¤. ì¦‰, ì „ì²´ íŠ¸ë˜í”½ì˜ 90%ëŠ” ê¸°ì¡´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ, ë‚˜ë¨¸ì§€ 10%ëŠ” ìƒˆë¡œìš´ ë²„ì „ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ì´ë™í•˜ê²Œ ë  ê²ƒì´ë‹¤. curlì„ í†µí•œ ìš”ì²­ì´ ì§€ì† ë˜ê³  ìˆìœ¼ë¯€ë¡œ ì´ ìƒíƒœë¡œë„ ì¼ì • ì‹œê°„ ì§€ë‚˜ê³ ë‚˜ì„œ my-app-v2ì˜ replicasë¥¼ 10ê°œë¡œ ëŠ˜ë¦¬ê³  ê¸°ì¡´ ë²„ì „ì¸ my-app-v1ì„ ëª¨ë‘ ì œê±°í•  ê²ƒì´ë‹¤.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span>k scale <span class="nt">--replicas</span><span class="o">=</span>10 deploy my-app-v2
  deployment.apps/my-app-v2 scaled
  son@son-localhost ~/k8s-deployment-strategies/canary/native <span class="nv">$ </span>k delete deploy my-app-v1
  deployment.apps <span class="s2">"my-app-v1"</span> deleted
</code></pre></div></div> <p><br /></p> <p>ë‹¤ìŒ ì˜ìƒì€ app-v1.yaml íŒŒì¼ì´ ë°°í¬ë˜ì–´ ìˆê³  ìœ„ì˜ app-v2.yamlì„ ë°°í¬í•˜ëŠ” ê³¼ì •ì—ì„œ podê°€ ì–´ë–»ê²Œ ë³€í™”í•˜ëŠ”ì§€ë¥¼ ì‚´í´ë³¼ ìˆ˜ ìˆë„ë¡ ì´¬ì˜í•´ë³´ì•˜ë‹¤.</p> <video width="100%" preload="auto" muted="" controls=""> <source src="/static/assets/video/blog/canary.mp4" type="video/mp4" /> </video> <p><br /></p> <h3 id="13-grafana-dashboard-í™•ì¸-">1.3. Grafana dashboard í™•ì¸ <a name="list1_3"></a></h3> <p>Canary ë°°í¬ë¥¼ í†µí•´ ì •ìƒì ìœ¼ë¡œ ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œ ë°°í¬ ë˜ì—ˆë‹¤ë©´ ë§ˆì°¬ê°€ì§€ë¡œ Grafanaë¥¼ í†µí•´ Canary ë°°í¬ ê³¼ì •ì— ëŒ€í•œ ì§€ì†ì ì¸ ìš”ì²­ ë©”íŠ¸ë¦­ì„ í™•ì¸í•´ë³¼ ê²ƒì´ë‹¤. ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ ë°°í¬í•´ ë‘ì—ˆë˜ Grafanaì— ì ‘ì†í•˜ê¸° ìœ„í•´ localhost:3000ìœ¼ë¡œ ì ‘ê·¼í•˜ì—¬ ë§Œë“¤ì–´ ë‘” íŒ¨ë„ì„ <strong>refresh</strong>í•´ë³´ì. ë‹¤ìŒ [ê·¸ë¦¼ 2]ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/infra/canary2.png" alt="request_total_panel" width="100%" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 2] Request Total íŒ¨ë„ í™•ì¸</td> </tr> </tbody> </table> <p><br /></p> <p>my-app-v2ê°€ ë°°í¬ë˜ì—ˆì„ ë•ŒëŠ” ì•½ 10%ì˜ ë©”íŠ¸ë¦­ì´ ì ì§„ì ìœ¼ë¡œ ë°œìƒí•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆê³ , ê·¸ í›„ì— my-app-v2ì˜ replicasë¥¼ 10ìœ¼ë¡œ ì˜¬ë¦¬ê³ , my-app-v1ì„ ì‚­ì œí•˜ê³ ë‚˜ì„œë¶€í„°ëŠ” ì ì§„ì ìœ¼ë¡œ my-app-v2ë¡œ êµì²´ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. Blue/Greenê³¼ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ëŠ” ìœ ì‚¬í•˜ì§€ë§Œ ì´ë ‡ê²Œ ê°€ëŠ¥í•œ ì´ìœ ëŠ” ìœ„ì˜ ë‘ ë²„ì „ì˜ deploymentëŠ” ë™ì¼í•œ app selectorë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì´ë‹¤.</p> <p><br /></p> <p>ì—¬ê¸°ê¹Œì§€ Kubernetesì—ì„œ ë¬´ì¤‘ë‹¨ ë°°í¬ ì „ëµë“¤ì˜ êµ¬í˜„ ë°©ë²•ê³¼ Grafanaë¥¼ í†µí•œ ë°°í¬ ê³¼ì •ì— ëŒ€í•œ ë©”íŠ¸ë¦­ì„ í™•ì¸í•´ë³´ëŠ” ì‹œê°„ì„ ê°€ì ¸ë³´ì•˜ë‹¤. ìš°ë¦¬ê°€ ìš´ì˜í•˜ëŠ” ì„œë¹„ìŠ¤ì˜ íŠ¹ì§• í˜¹ì€ ë°°í¬í•  ë•Œ í•„ìš”í•œ ìš”êµ¬ì‚¬í•­ë“¤ì„ ì˜ ê³ ë ¤í•˜ì—¬ ì–´ë–¤ ì „ëµìœ¼ë¡œ ë°°í¬í• ì§€ ì˜ ê²°ì •í•´ì•¼í•  ê²ƒ ê°™ë‹¤.</p> <p><br /></p> <hr> <div class="row"> <div class="col-md-6"> <h5 style="display: inline;">Tags:</h5> <button class="btn btn-white btn-xs" type="button">son</button> <button class="btn btn-white btn-xs" type="button">blog</button> <button class="btn btn-white btn-xs" type="button">infra</button> <button class="btn btn-white btn-xs" type="button">docker</button> <button class="btn btn-white btn-xs" type="button">minikube</button> <button class="btn btn-white btn-xs" type="button">kubernetes</button> <button class="btn btn-white btn-xs" type="button">grafana</button> <button class="btn btn-white btn-xs" type="button">canary</button> </div> <div class="col-md-6"> <div class="small text-right"> <div> <i class="fa fa-comments-o"> </i> <span class="disqus-comment-count" data-disqus-url="http://192.168.116.128:4000/infra/2022/10/24/canary.html">0</span> comments </div> </div> </div> </div> <div class="PageNavigation"> <a class="prev" href="/infra/2022/10/23/blue-green.html">&laquo; [Infra] Kubernetes Blue/Green ë°°í¬ ì „ëµ ì‹¤ìŠµ</a> </div> <br> <div class="row"> <div class="col-lg-12"> <!-- donate --> <br> <!-- share --> <div class="a2a_kit a2a_kit_size_32 a2a_default_style"> <a class="a2a_dd" href="https://www.addtoany.com/share"></a> <a class="a2a_button_facebook"></a> <a class="a2a_button_twitter"></a> <a class="a2a_button_google_plus"></a> <a class="a2a_button_linkedin"></a> <a class="a2a_button_email"></a> <a class="a2a_button_wechat"></a> <a class="a2a_button_sina_weibo"></a> <a class="a2a_button_pocket"></a> </div> <script> var a2a_config = a2a_config || {}; a2a_config.color_main = "D7E5ED"; a2a_config.color_border = "AECADB"; a2a_config.color_link_text = "333333"; a2a_config.color_link_text_hover = "333333"; </script> <script async src="https://static.addtoany.com/menu/page.js"></script> <br> <!-- comment --> <div id="disqus_thread"></div> <script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { var d = document, s = d.createElement('script'); s.src = '//son.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div> </div> </div> </div> </div> </div> </div> <!-- Google analytics --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-93473370-3', 'auto'); ga('require', ''); ga('send', 'pageview'); </script> <!-- GrowingIO --> <script id="dsq-count-scr" src="https://son.disqus.com/count.js" async></script> </body> </html>
