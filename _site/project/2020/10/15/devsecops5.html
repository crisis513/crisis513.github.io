<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1; minimum-scale=1; user-scalable=no;"> <meta content="[Project] DevSecOps í”„ë¡œì íŠ¸ - Jenkinsì™€ Slack ì—°ë™ ê·¸ë¦¬ê³  ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ì˜ ì‚¬ìš©" name="description"> <meta name="keywords" content="son,blog,project,devsecops,devops,gcp,jenkins,slack,multi-branch,pipeline"> <meta name="author" content="son"> <meta name="baseurl" content=""> <title> son | [Project] DevSecOps í”„ë¡œì íŠ¸ - Jenkinsì™€ Slack ì—°ë™ ê·¸ë¦¬ê³  ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ì˜ ì‚¬ìš© </title> <!-- favicon --> <link rel="shortcut icon" href="/static/assets/img/favicon.ico"> <!-- Main CSS --> <link href="/static/assets/app-20200311.min.css" rel="stylesheet"> <link href="/static/css/custom.css" rel="stylesheet"> <!-- Main Scripts --> <script src="/static/assets/app-20200311.min.js"></script> <script src="/static/assets/blog-20200311.min.js"></script> <!-- Google AdSense --> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script> (adsbygoogle = window.adsbygoogle || []).push({ google_ad_client: "ca-pub-6196184620200311", enable_page_level_ads: true }); </script> </head> <body id="page-top" class="landing-page"> <div class="search-tool" style="position: fixed; top: 0px ; bottom: 0px; left: 0px; right: 0px; opacity: 0.95; background-color: #111111; z-index: 9999; display: none;"> <input type="text" class="form-control search-content" id="search-content" style="position: fixed; top: 60px" placeholder="Search Blog"> <div style="position: fixed; top: 16px; right: 16px; z-index: 9999;"> <img src="/static/assets/img/search/cb-close.png" id="close-btn"/> </div> </div> <div style="position: fixed; right: 16px; bottom: 20px; z-index: 9999;"> <img src="/static/assets/img/search/cb-search.png" id="search-btn" title="Double click Ctrl"/> </div> <div class="navbar-wrapper"> <nav class="navbar navbar-default navbar-fixed-top" role="navigation"> <div class="container"> <div class="navbar-header page-scroll"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="/">son</a> </div> <div id="navbar" class="navbar-collapse collapse"> <ul class="nav navbar-nav navbar-right"> <li><a class="page-scroll" href="blog/"></a></li> <li> <a class="page-scroll" href="/blog/">All</a></li> <li> <a class="page-scroll" href="/project/">Project</a></li> <li> <a class="page-scroll" href="/research/">Research</a></li> <li> <a class="page-scroll" href="/troubleshooting/">Troubleshooting</a></li> <li> <a class="page-scroll" href="/infra/">Infra</a></li> <li> <a class="page-scroll" href="/data/">Data</a></li> <li> <a class="page-scroll" href="/anything/">Anything</a></li> </ul> </div> </div> </nav> </div> <div id="inSlider" class="carousel carousel-fade" data-ride="carousel"> <ol class="carousel-indicators"> <li data-target="#inSlider" data-slide-to="0" class="active"></li> <li data-target="#inSlider" data-slide-to="1"></li> <li data-target="#inSlider" data-slide-to="2"></li> </ol> <div class="carousel-inner" role="listbox"> <div class="item active"> <div class="container"> <div class="carousel-caption"> </div> <div class="carousel-image wow zoomIn"> <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> --> </div> </div> <!-- Set background for slide in css --> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_one.jpg);" title="han-gi's blog"> </div> </div> <div class="item"> <div class="container"> <div class="carousel-caption"> </div> <div class="carousel-image wow zoomIn"> <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> --> </div> </div> <!-- Set background for slide in css --> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_two.jpg);" title="han-gi's blog"></div> </div> <div class="item"> <div class="container"> <div class="carousel-caption"> </div> <div class="carousel-image wow zoomIn"> <!-- <img src="static/img/landing/laptop.png" alt="laptop"/> --> </div> </div> <!-- Set background for slide in css --> <div class="header-back" style="background-image: url(/static/assets/img/landing/header_three.jpg);" title="han-gi's blog"></div> </div> </div> <a class="left carousel-control" href="#inSlider" role="button" data-slide="prev"> <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span> <span class="sr-only">Previous</span> </a> <a class="right carousel-control" href="#inSlider" role="button" data-slide="next"> <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span> <span class="sr-only">Next</span> </a> </div> <div class="wrapper wrapper-content animated fadeInRight article"> <div class="row"> <div class="col-lg-10 col-lg-offset-1"> <div class="ibox"> <div class="ibox-content"> <div class="pull-right"> <a class="btn btn-white btn-xs" href="/project">Project</a> </div> <div class="text-center article-title"> <span class="text-muted"><i class="fa fa-clock-o"></i> 15 Oct 2020</span> <h1> [Project] DevSecOps í”„ë¡œì íŠ¸ - Jenkinsì™€ Slack ì—°ë™ ê·¸ë¦¬ê³  ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ì˜ ì‚¬ìš© </h1> </div> <div class="ksJIXb"> <div class="ikVqUi"> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#ê°œìš”">ê°œìš”</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#1-ë‚´-ì§ˆë¬¸ì—ëŠ”-ì™œ-ë‹µë³€ì—-ë‹¬ë¦¬ì§€-ì•Šì„ê¹Œ---ê°œë°œìê°€-ì§ˆë¬¸í•˜ëŠ”-ë²•">1. ë‚´ ì§ˆë¬¸ì—ëŠ” ì™œ ë‹µë³€ì— ë‹¬ë¦¬ì§€ ì•Šì„ê¹Œ? - ê°œë°œìê°€ ì§ˆë¬¸í•˜ëŠ” ë²•</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#1-ì§ˆë¬¸ì„-í•˜ê¸°-ì „ì—-í•´ì•¼-í• -ê²ƒë“¤">1) ì§ˆë¬¸ì„ í•˜ê¸° ì „ì— í•´ì•¼ í•  ê²ƒë“¤</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#2-ì´ì œ-ê²€ìƒ‰í•´ë³´ì">2) ì´ì œ ê²€ìƒ‰í•´ë³´ì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#3-ê·¸ë˜ë„-í•´ê²°ì´-ì•ˆ-ë˜ì—ˆìœ¼ë©´-ì§ˆë¬¸ì„-í•˜ì">3) ê·¸ë˜ë„ í•´ê²°ì´ ì•ˆ ë˜ì—ˆìœ¼ë©´ ì§ˆë¬¸ì„ í•˜ì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#2-ì§ˆë¬¸ì„-ì˜í•˜ëŠ”-ê°œë°œì">2. ì§ˆë¬¸ì„ ì˜í•˜ëŠ” ê°œë°œì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#1-ì¶©ë¶„í•œ-êµ¬ê¸€ë§ì„-ìš°ì„ -ì„ í–‰í•˜ì">1) ì¶©ë¶„í•œ êµ¬ê¸€ë§ì„ ìš°ì„  ì„ í–‰í•˜ì</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#2-ë™ë£Œì˜-ì‹œê°„ì„-ë‚­ë¹„í•˜ì§€-ë§ìì§ˆë¬¸-ì •ë¦¬í•´ì•¼-í•˜ëŠ”-ì´ìœ ">2) ë™ë£Œì˜ ì‹œê°„ì„ ë‚­ë¹„í•˜ì§€ ë§ì(ì§ˆë¬¸ ì •ë¦¬í•´ì•¼ í•˜ëŠ” ì´ìœ )</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#3-ì§ˆë¬¸-ì •ë¦¬í•˜ê¸°">3) ì§ˆë¬¸ ì •ë¦¬í•˜ê¸°</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 24px;"><a href="#4-í•œ-ê±¸ìŒ-ë”-ë‚˜ì•„ê°€ì„œ">4) í•œ ê±¸ìŒ ë” ë‚˜ì•„ê°€ì„œ!</a></div> <div class="sc-fXEqDS bXGcfF" style="margin-left: 0px;"><a href="#-íšŒê³ ">ğŸ¹ íšŒê³ </a></div> </div> </div> <h2 id="ëª©ì°¨">ëª©ì°¨</h2> <p><a href="#list1">1. Jekninsì™€ Slack ì—°ë™</a></p> <p><a href="#list1_1">Â Â  1.1. Slack ì„¤ì •</a></p> <p><a href="#list1_2">Â Â  1.2. Jenkins ì„¤ì •</a></p> <p><a href="#list2">2. ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ ì‚¬ìš©</a></p> <p><a href="#list2_1">Â Â  2.1. ë©€í‹° ë¸Œëœì¹˜ ì„¤ì •</a></p> <p><a href="#list2_2">Â Â  2.2. ë©€í‹° ë¸Œëœì¹˜ í…ŒìŠ¤íŠ¸</a></p> <hr /> <h2 id="1-jekninsì™€-slack-ì—°ë™---"><span style="color:purple"><strong>1. Jekninsì™€ Slack ì—°ë™</strong></span> <a name="list1"></a></h2> <p><br /></p> <ul> <li> <p><strong>Slack ì„¤ì •</strong> <a name="list1_1"></a></p> <p>ë¨¼ì € Jenkins íŒŒì´í”„ë¼ì¸ì˜ ì‹¤í–‰ ê²°ê³¼ì— ëŒ€í•œ ë©”ì‹œì§€ë¥¼ ë°›ì•„ë³´ê¸° ìœ„í•´ Slackì—ì„œ ì‚¬ìš©í•  ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì™€ ì±„ë„ì„ ìƒì„±í•´ì¤€ë‹¤.</p> <p>ì›ŒìŠ¤í¬í˜ì´ìŠ¤ì™€ ì±„ë„ì„ ìƒì„±í•˜ê³ ë‚˜ë©´ <code class="language-plaintext highlighter-rouge">https://YOUR_WORKSPACE.slack.com/apps</code> URLì— ì ‘ì†í•´ì„œ Slackì— ì¶”ê°€ í•  ì•±ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">Jenkins CI</code>ë¥¼ ê²€ìƒ‰í•œë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_1.png" alt="add_jenkins_ci" width="461" height="435" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 1] Jenkins CI ì•± ì¶”ê°€</td> </tr> </tbody> </table> <p><br /></p> <p><code class="language-plaintext highlighter-rouge">Slackì— ì¶”ê°€</code> ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ì•ì„œ ìƒì„±í•´ë‘” ì±„ë„ì„ ì„ íƒí•˜ì—¬ í•´ë‹¹ ì±„ë„ì—ì„œ Jenkinsì˜ ë©”ì‹œì§€ë¥¼ ë°›ì•„ ë³¼ ìˆ˜ ìˆë„ë¡ ì„¤ì •í•œë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_2.png" alt="jenkins_ci_configure" width="632" height="569" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 2] Jenkins CI êµ¬ì„± í¸ì§‘</td> </tr> </tbody> </table> <p><br /></p> <p>ì •ìƒì ìœ¼ë¡œ Jenkins CI ì•±ì´ ì¶”ê°€ë˜ë©´ <code class="language-plaintext highlighter-rouge">êµ¬ì„±</code> íƒ­ì„ ëˆŒëŸ¬ <code class="language-plaintext highlighter-rouge">êµ¬ì„± í¸ì§‘</code>ì— ë“¤ì–´ê°€ë©´ ìœ„ì˜ [ê·¸ë¦¼ 2]ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤.</p> <p>ì•„ë˜ìª½ì— ë³´ë©´ í† í°ì´ ë°œê¸‰ë˜ì–´ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì„í…ë°, <strong>ì´ í† í°ì€ ë‚˜ì¤‘ì— Jenkins credentialsì„ ìƒì„±í•  ë•Œ ì‚¬ìš©</strong>ëœë‹¤.</p> <p>ì—¬ê¸°ê¹Œì§€ ì„¤ì •í–ˆë‹¤ë©´ Slackì—ì„œì˜ ì„¤ì •ì€ ëë‚œ ê²ƒì´ë‹¤.</p> <p><br /></p> </li> <li> <p><strong>Jenkins ì„¤ì •</strong> <a name="list1_2"></a></p> <p>ë‹¤ìŒìœ¼ë¡œ Jenkinsì—ì„œ Slackê³¼ ì—°ë™í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê² ë‹¤.</p> <p>ë¨¼ì € Jenkins ì„¤ì •ì—ì„œ Slack í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•´ì¤€ë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_3.png" alt="install_slack_plugin" width="667" height="252" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 3] Slack í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜</td> </tr> </tbody> </table> <p><br /></p> <p>Jenkinsì—ì„œ Slack í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ê³ ë‚˜ë©´ <code class="language-plaintext highlighter-rouge">ì‹œìŠ¤í…œ ì„¤ì •</code> íƒ­ì˜ ë§¨ ì•„ë˜ìª½ì— Slack ì„¤ì • ê³µê°„ì´ ìˆë‹¤.</p> <p>ë‹¤ìŒ [ê·¸ë¦¼ 4]ì™€ ê°™ì´ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì™€ Credentials, ì±„ë„ IDë¥¼ ì •í™•í•˜ê²Œ ê¸°ì…í•´ì¤€ë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_4.png" alt="jenkins_slack_configuration" width="713" height="275" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 4] Jenkinsì—ì„œ Slack ì„¤ì •</td> </tr> </tbody> </table> <p><br /></p> <p>Credentialsì˜ ê²½ìš°ì— ì˜†ì˜ <code class="language-plaintext highlighter-rouge">Add</code> ë²„íŠ¼ì„ ëˆŒëŸ¬ Slackì˜ Credentialsë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.</p> <p>Credentialsë¥¼ ì¶”ê°€í•  ë•Œ KindëŠ” <code class="language-plaintext highlighter-rouge">Secret text</code>ë¡œ ë‘ê³  Secretì€ [ê·¸ë¦¼ 2]ì—ì„œ ë³´ì´ëŠ” <code class="language-plaintext highlighter-rouge">í† í°</code> ê°’ì„ ì…ë ¥í•´ì¤€ë‹¤.</p> <p>ê·¸ëŸ° ìš°ì¸¡ í•˜ë‹¨ì˜ <code class="language-plaintext highlighter-rouge">Test Connection</code> ë²„íŠ¼ì„ ëˆŒëŸ¬ ì •ìƒì ìœ¼ë¡œ ì—°ë™ë˜ì–´ Success ë¬¸êµ¬ê°€ ëœ¨ëŠ”ì§€ í™•ì¸í•œë‹¤.</p> <p><br /></p> <p>Jenkinsì™€ Slackì´ ì •ìƒì ìœ¼ë¡œ ì—°ë™ë˜ê³ ë‚˜ë©´ ë‹¤ì‹œ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ëŒì•„ì™€ì„œ, íŒŒì´í”„ë¼ì¸ì´ ëª¨ë‘ ì‹¤í–‰ë˜ê³ ë‚˜ì„œ Slackì— ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ê² ë‹¤.</p> <p>íŒŒì´í”„ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì˜ ë‚´ìš©ì„ ì•ì„  í¬ìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í–ˆë˜ ìŠ¤í¬ë¦½íŠ¸ì— ì¶”ê°€í–ˆë‹¤.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  pipeline <span class="o">{</span>
      environment <span class="o">{</span>
          SLACK_CHANNEL <span class="o">=</span> <span class="s1">'#send-slack-message-from-jenkins'</span>
      <span class="o">}</span>
      ...<span class="o">(</span>ì¤‘ëµ<span class="o">)</span> 
      post <span class="o">{</span> 
          success <span class="o">{</span> 
              slackSend <span class="o">(</span>channel: SLACK_CHANNEL, color: <span class="s1">'#00FF00'</span>, message: <span class="s2">"SUCCESSFUL: Job '</span><span class="k">${</span><span class="nv">env</span><span class="p">.JOB_NAME</span><span class="k">}</span><span class="s2"> [</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_NUMBER</span><span class="k">}</span><span class="s2">]' (</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_URL</span><span class="k">}</span><span class="s2">)"</span><span class="o">)</span> 
          <span class="o">}</span>
          failure <span class="o">{</span>
              slackSend <span class="o">(</span>channel: SLACK_CHANNEL, color: <span class="s1">'#F01717'</span>, message: <span class="s2">"FAILURE: Job '</span><span class="k">${</span><span class="nv">env</span><span class="p">.JOB_NAME</span><span class="k">}</span><span class="s2"> [</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_NUMBER</span><span class="k">}</span><span class="s2">]' (</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_URL</span><span class="k">}</span><span class="s2">)"</span><span class="o">)</span>
          <span class="o">}</span>
      <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div> </div> <p>íŒŒì´í”„ë¼ì¸ì„ ëª¨ë‘ ì‹¤í–‰í•˜ê³  ë‚˜ì„œ íŒŒì´í”„ë¼ì¸ì´ ì„±ê³µ í˜¹ì€ ì‹¤íŒ¨ ìƒíƒœì¸ì§€ í™•ì¸í•˜ì—¬ ìƒíƒœì— ë§ê²Œ Slack ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë„ë¡ ì‘ì„±í–ˆë‹¤.</p> <p>ì„±ê³µí•˜ë©´ â€˜SUCCESSFULâ€™ì´ë¼ëŠ” ë¬¸êµ¬ì™€ í•¨ê»˜ ì´ˆë¡ìƒ‰ìœ¼ë¡œ ë©”ì‹œì§€ê°€ ì „ë‹¬ë  ê²ƒì´ê³ , ì‹¤íŒ¨í•˜ë©´ â€˜FAILUREâ€™ì´ë¼ëŠ” ë¬¸êµ¬ì™€ í•¨ê»˜ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ë©”ì‹œì§€ê°€ ì „ë‹¬ë  ê²ƒì´ë‹¤.</p> <p>ë‹¤ìŒ [ê·¸ë¦¼ 5]ëŠ” íŒŒì´í”„ë¼ì¸ì´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ Slackìœ¼ë¡œ ë©”ì‹œì§€ê°€ ì „ë‹¬ ë˜ì—ˆì„ ê²½ìš°ì´ë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_5.png" alt="slack_message" width="485" height="183" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 5] Slack ë©”ì‹œì§€ í™•ì¸</td> </tr> </tbody> </table> <p><br /></p> </li> </ul> <h2 id="2-ë©€í‹°-ë¸Œëœì¹˜-íŒŒì´í”„ë¼ì¸-ì‚¬ìš©---"><span style="color:purple"><strong>2. ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ ì‚¬ìš©</strong></span> <a name="list2"></a></h2> <p><br /></p> <ul> <li> <p><strong>ë©€í‹° ë¸Œëœì¹˜ ì„¤ì •</strong> <a name="list2_1"></a></p> <p>ì´ë²ˆì—ëŠ” Jenkinsì—ì„œ ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ì„ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì.</p> <p>ë¨¼ì € Jenkins ì‹œìŠ¤í…œ ì„¤ì •ì—ì„œ ë‹¤ìŒ [ê·¸ë¦¼ 6]ê³¼ ê°™ì´ GitLab ì„œë²„ì— ëŒ€í•´ ì„¤ì •í•´ì•¼ í•œë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_6.png" alt="gitlab_server_configuration" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 6] Jenkinsì—ì„œ GitLab ì„œë²„ ì„¤ì •</td> </tr> </tbody> </table> <p><br /></p> <p>ê·¸ëŸ° ë‹¤ìŒ Jenkins í™ˆì—ì„œ ì™¼ìª½ íƒ­ì˜ <code class="language-plaintext highlighter-rouge">ìƒˆë¡œìš´ Item</code>ì—ì„œ <code class="language-plaintext highlighter-rouge">Multibranch Pipeline</code>ì„ ìƒì„±í•´ì¤€ë‹¤.</p> <p>ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ì„ ë§Œë“¤ ë•Œ Branch Sources í•­ëª©ì—ì„œ <code class="language-plaintext highlighter-rouge">Add Source -&gt; GitLab Project</code>ë¥¼ ëˆŒëŸ¬ ë‹¤ìŒ [ê·¸ë¦¼ 7]ê³¼ ê°™ì´ ì„¤ì •í•´ì¤€ë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_7.png" alt="multibranch_gitlab_configuration" width="653" height="623" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 7] ë©€í‹°ë¸Œëœì¹˜ GitLab ì„¤ì •</td> </tr> </tbody> </table> <p><br /></p> <p>ServerëŠ” [ê·¸ë¦¼ 6]ì—ì„œ ì •ìƒì ìœ¼ë¡œ ì„¤ì •í–ˆë‹¤ë©´ ìë™ìœ¼ë¡œ ì¡í˜€ìˆì„ ê²ƒì´ê³ , CredentialsëŠ” CI ì„¤ì •í•  ë•Œ ë§Œë“¤ì–´ë‘ì—ˆë˜ ê²ƒì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ì£¼ì‹œë©´ ëœë‹¤.</p> <p>ê·¸ë¦¬ê³  íŒŒì´í”„ë¼ì¸ì— ì—°ê²°í•  í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•œ ê³„ì •ì˜ IDë¥¼ Ownerë¡œ ë‘ë©´ í•´ë‹¹ IDì—ì„œ ê´€ë¦¬í•˜ê³  ìˆëŠ” í”„ë¡œì íŠ¸ë“¤ì„ ì•„ë˜ Projectsì—ì„œ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</p> <p>Behaviours í•­ëª©ì—ì„œ Add ë²„íŠ¼ì„ ëˆŒëŸ¬ <code class="language-plaintext highlighter-rouge">Filter by name (with wildcards)</code>ë¥¼ ìƒì„±í•´ì£¼ê³ , ìœ„ì—ì„œ ì„ íƒí•œ í”„ë¡œì íŠ¸ì—ì„œ íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•  ë¸Œëœì¹˜ë“¤ì˜ ì´ë¦„ì„ Includeì— ì ì–´ë‘ë©´ ëœë‹¤.</p> <p><br /></p> <p>ë©€í‹° ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ì€ ê° ë¸Œëœì¹˜ë“¤ì— Jenkinsfileì„ ìƒì„±í•˜ì—¬ Jenkinsfileì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ë‘ì–´ì•¼ í•œë‹¤.</p> <p><strong>master ë¸Œëœì¹˜ì—ì„œëŠ” CI/CD íŒŒì´í”„ë¼ì¸ì´ ëª¨ë‘ ë™ì‘í•˜ì—¬ ë¹Œë“œë¶€í„° ë°°í¬ê¹Œì§€ ëª¨ë‘ ì§„í–‰ë˜ë„ë¡ ê·¸ëŒ€ë¡œ ë‘ì—ˆê³ ,</strong></p> <p><strong>release ë¸Œëœì¹˜ì—ì„œëŠ” CI íŒŒì´í”„ë¼ì¸ë§Œ ë™ì‘í•˜ë„ë¡ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í–ˆë‹¤.</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  pipeline <span class="o">{</span>
      environment <span class="o">{</span>
          registry <span class="o">=</span> <span class="s2">"crisis513/flask-app"</span>
          registryCredential <span class="o">=</span> <span class="s1">'crisis513'</span>
          dockerImage <span class="o">=</span> <span class="s1">''</span>
          releaseName <span class="o">=</span> <span class="s2">"flask-app"</span>
          helmChartRepo <span class="o">=</span> <span class="s2">"flask-kubernetes-helm"</span>
          release_version <span class="o">=</span> <span class="s1">'latest'</span>
          SLACK_CHANNEL <span class="o">=</span> <span class="s1">'#send-slack-message-from-jenkins'</span>
      <span class="o">}</span>

      agent <span class="o">{</span>
          label <span class="s2">"jenkins-slave"</span>
      <span class="o">}</span>
      stages <span class="o">{</span>
          stage<span class="o">(</span><span class="s1">'Cloning our Git'</span><span class="o">)</span> <span class="o">{</span>
              steps <span class="o">{</span>
                  git <span class="s1">'http://GITLAB_SERVER_IP:8001/root/flask-app.git'</span>
              <span class="o">}</span>
          <span class="o">}</span>
          stage<span class="o">(</span><span class="s1">'Building docker image'</span><span class="o">)</span> <span class="o">{</span>
              steps <span class="o">{</span>
                  script <span class="o">{</span>
                      dockerImage <span class="o">=</span> docker.build registry + <span class="s2">":</span><span class="k">${</span><span class="nv">release_version</span><span class="k">}</span><span class="s2">"</span>
                  <span class="o">}</span>
              <span class="o">}</span>
          <span class="o">}</span>
          stage<span class="o">(</span><span class="s1">'Deploy docker image'</span><span class="o">)</span> <span class="o">{</span>
              when <span class="o">{</span>
                  branch <span class="s1">'master'</span>
              <span class="o">}</span>
              steps <span class="o">{</span>
                  script <span class="o">{</span>
                      docker.withRegistry<span class="o">(</span> <span class="s1">''</span>, registryCredential <span class="o">)</span> <span class="o">{</span>
                          dockerImage.push<span class="o">()</span>
                      <span class="o">}</span>
                  <span class="o">}</span>
              <span class="o">}</span>
          <span class="o">}</span>
          stage<span class="o">(</span><span class="s1">'Cleaning up'</span><span class="o">)</span> <span class="o">{</span>
              when <span class="o">{</span>
                  branch <span class="s1">'master'</span>
              <span class="o">}</span>
              steps <span class="o">{</span>
                  sh <span class="s2">"docker rmi </span><span class="nv">$registry</span><span class="s2">:</span><span class="k">${</span><span class="nv">release_version</span><span class="k">}</span><span class="s2">"</span>
              <span class="o">}</span>
          <span class="o">}</span>
          stage<span class="o">(</span><span class="s1">'Deploy image to kubernetes'</span><span class="o">)</span> <span class="o">{</span>
              when <span class="o">{</span>
                  branch <span class="s1">'master'</span>
              <span class="o">}</span>
              steps <span class="o">{</span>
                  sh <span class="s2">"""
                      helm lint </span><span class="k">${</span><span class="nv">helmChartRepo</span><span class="k">}</span><span class="s2">
                      helm upgrade </span><span class="k">${</span><span class="nv">releaseName</span><span class="k">}</span><span class="s2"> </span><span class="k">${</span><span class="nv">helmChartRepo</span><span class="k">}</span><span class="s2">
                  """</span>
              <span class="o">}</span>
          <span class="o">}</span>
      <span class="o">}</span>
      post <span class="o">{</span> 
          success <span class="o">{</span> 
              slackSend <span class="o">(</span>channel: SLACK_CHANNEL, color: <span class="s1">'#00FF00'</span>, message: <span class="s2">"SUCCESSFUL: Job '</span><span class="k">${</span><span class="nv">env</span><span class="p">.JOB_NAME</span><span class="k">}</span><span class="s2"> [</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_NUMBER</span><span class="k">}</span><span class="s2">]' (</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_URL</span><span class="k">}</span><span class="s2">)"</span><span class="o">)</span> 
          <span class="o">}</span> 
          failure <span class="o">{</span> 
              slackSend <span class="o">(</span>channel: SLACK_CHANNEL, color: <span class="s1">'#FF0000'</span>, message: <span class="s2">"FAILED: Job '</span><span class="k">${</span><span class="nv">env</span><span class="p">.JOB_NAME</span><span class="k">}</span><span class="s2"> [</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_NUMBER</span><span class="k">}</span><span class="s2">]' (</span><span class="k">${</span><span class="nv">env</span><span class="p">.BUILD_URL</span><span class="k">}</span><span class="s2">)"</span><span class="o">)</span> 
          <span class="o">}</span>
      <span class="o">}</span> 
  <span class="o">}</span>
</code></pre></div> </div> <p><br /></p> </li> <li> <p><strong>ë©€í‹° ë¸Œëœì¹˜ í…ŒìŠ¤íŠ¸</strong> <a name="list2_2"></a></p> <p>release íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰ì‹œì¼œ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ë©´ ë‹¤ìŒ [ê·¸ë¦¼ 8]ê³¼ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/static/assets/img/landing/project/devsecops_5_8.png" alt="release_pipeline_test" /></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">[ê·¸ë¦¼ 8] release ë¸Œëœì¹˜ íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸</td> </tr> </tbody> </table> <p><br /></p> <p>Git cloneí•˜ì—¬ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí•˜ëŠ” ë¶€ë¶„ê¹Œì§€ëŠ” ì •ìƒ ë™ì‘í•˜ì§€ë§Œ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë°°í¬í•˜ê³  ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì— ë°°í¬í•˜ê¸°ê¹Œì§€ì˜ ê³¼ì •ì€ master ë¸Œëœì¹˜ì—ì„œë§Œ ë™ì‘í•˜ë„ë¡ ì„¤ì •í•˜ì˜€ê¸° ë•Œë¬¸ì— ìƒë½ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p> <p><br /></p> <p>ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì§€ê¸ˆê¹Œì§€ ì„¤ì •í•´ ë‘” DevOps íŒŒì´í”„ë¼ì¸ì—ì„œ SAST(Static Application Security Testing)ë¥¼ ì ìš©í•˜ì—¬ ìë™ìœ¼ë¡œ ì •ì  í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì³ ë°°í¬í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ê¸°ìˆ í•´ë³´ê² ë‹¤!</p> </li> </ul> <hr> <div class="row"> <div class="col-md-6"> <h5 style="display: inline;">Tags:</h5> <button class="btn btn-white btn-xs" type="button">son</button> <button class="btn btn-white btn-xs" type="button">blog</button> <button class="btn btn-white btn-xs" type="button">project</button> <button class="btn btn-white btn-xs" type="button">devsecops</button> <button class="btn btn-white btn-xs" type="button">devops</button> <button class="btn btn-white btn-xs" type="button">gcp</button> <button class="btn btn-white btn-xs" type="button">jenkins</button> <button class="btn btn-white btn-xs" type="button">slack</button> <button class="btn btn-white btn-xs" type="button">multi-branch</button> <button class="btn btn-white btn-xs" type="button">pipeline</button> </div> <div class="col-md-6"> <div class="small text-right"> <div> <i class="fa fa-comments-o"> </i> <span class="disqus-comment-count" data-disqus-url="http://192.168.116.128:4000/project/2020/10/15/devsecops5.html">0</span> comments </div> </div> </div> </div> <div class="PageNavigation"> <a class="prev" href="/project/2020/10/13/devsecops4.html">&laquo; [Project] DevSecOps í”„ë¡œì íŠ¸ - Helmì„ í†µí•œ ëª¨ë‹ˆí„°ë§ê³¼ ë¡œê¹… ì‹œìŠ¤í…œ êµ¬ì¶•</a> <a class="next" href="/project/2020/10/21/devsecops6.html">[Project] DevSecOps í”„ë¡œì íŠ¸ - SAST ë¶„ì„ ë° í™œìš© &raquo;</a> </div> <br> <div class="row"> <div class="col-lg-12"> <!-- donate --> <br> <!-- share --> <div class="a2a_kit a2a_kit_size_32 a2a_default_style"> <a class="a2a_dd" href="https://www.addtoany.com/share"></a> <a class="a2a_button_facebook"></a> <a class="a2a_button_twitter"></a> <a class="a2a_button_google_plus"></a> <a class="a2a_button_linkedin"></a> <a class="a2a_button_email"></a> <a class="a2a_button_wechat"></a> <a class="a2a_button_sina_weibo"></a> <a class="a2a_button_pocket"></a> </div> <script> var a2a_config = a2a_config || {}; a2a_config.color_main = "D7E5ED"; a2a_config.color_border = "AECADB"; a2a_config.color_link_text = "333333"; a2a_config.color_link_text_hover = "333333"; </script> <script async src="https://static.addtoany.com/menu/page.js"></script> <br> <!-- comment --> <div id="disqus_thread"></div> <script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */ /* var disqus_config = function () { this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function() { var d = document, s = d.createElement('script'); s.src = '//son.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript> </div> </div> </div> </div> </div> </div> </div> <!-- Google analytics --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-93473370-3', 'auto'); ga('require', ''); ga('send', 'pageview'); </script> <!-- GrowingIO --> <script id="dsq-count-scr" src="https://son.disqus.com/count.js" async></script> </body> </html>
