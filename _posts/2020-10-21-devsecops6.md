---
layout: post
title: "[Project] DevSecOps 프로젝트 - SAST 분석 및 활용"
date: 2020-10-21
desc: "[Project] DevSecOps 프로젝트 - SAST 분석 및 활용"
keywords: "son,blog,project,devsecops,devops,gcp,jenkins,sast"
categories: [Project]
tags: [son,blog,project,devsecops,devops,gcp,jenkins,sast]
icon: icon-html
---

본 프로젝트는 클라우드컴퓨팅연구조합(CCCR)에서 클라우드 네이티브 환경에서 DevSecOps 툴 체인 파이프라인을 구축하는 프로젝트입니다.

9월에 시작하여 11월 27일까지 진행되고 현재 진행 중이며, 내용이 긴 만큼 여러 포스트를 나눠 기록하고자 합니다.

> **본 포스트의 내용은 프로젝트 도중 작성되어 추후 변경될 수 있음을 알립니다.**

---

## 목차

[1. DevSecOps 툴체인 보안 점검 리스트](#list1)

[&nbsp;&nbsp; 1.1. SANS DevSecOps Best Practice](#list1_1)

[&nbsp;&nbsp; 1.2. Pre-Commit 단계](#list1_2)

[&nbsp;&nbsp; 1.3. Commit 단계](#list1_3)

[2. SAST(Static Application Security Testing) 적용](#list2)

[&nbsp;&nbsp; 2.1. OWASP Dependency Check](#list2_1)

[&nbsp;&nbsp; 2.2. SpotBugs](#list2_2)

[&nbsp;&nbsp; 2.3. CheckStyle](#list2_3)

[&nbsp;&nbsp; 2.4. PMD(Programing Mistake Detector)](#list2_4)

[&nbsp;&nbsp; 2.5. SonarQube](#list2_5)

[&nbsp;&nbsp; 2.6. Anchore](#list2_6)

<br>

---

## <span style="color:purple">**1. DevSecOps 툴체인 보안 점검 리스트**</span>   <a name="list1"></a>

<br>

- **SANS DevSecOps Best Practice**   <a name="list1_1"></a>

    SANS 연구소(SANS Institute)는 교육에서 보안 인증 정보 소스를 보유하고 있으며 사이버 및 네트워크 방어, 침투 테스트, 사고 대응, 디지털 포렌식 등 보안 교육에 있어 국제적으로 가장 높은 신뢰를 받는 보안 기관입니다. 
    
    이러한 SANS 연구소에서 DevSecOps 도구들을 분류 및 정리하여 발표한 [Secure DevOps Toolchain and SWAT checklist](http://sans.org/u/zAi) 자료를 토대로 DevSecOps 파이프라인에서 정적 분석할 도구를 선정할 것입니다. 

    도구 선정은 앞선 포스팅을 통해 구축된 DevOps 파이프라인에 쉽게 연결할 수 있고, 자동화되어 정적 분석 및 동적 분석을 수행할 수 있는 보안 도구를 선택하였습니다.

    <br>

- **Pre-Commit 단계**   <a name="list1_2"></a>

    먼저 DevSecOps 파이프라인의 첫 번째 단계인 Pre-Commit 단계에서는 개발자가 코드를 GitLab과 같은 SCM에 Commit 되기 전에 완료해야하는 단계입니다.

    다음 [그림 1]은 SANS 연구소에서 정리한 Pre-Commit 단계에서 사용할 수 있는 보안 도구들을 정리한 것입니다.

    | ![pre_commit_security_tool](/static/assets/img/landing/project/devsecops_6_1.png){: width="758" height="273"} |
    |:--:| 
    | [그림 1] Pre-Commit 단계의 보안 도구 |

    <br>

    Pre-Commit 단계는 VSCode와 같은 IDE(Integrated Development Environment)에 보안 도구들을 플러그인으로 추가하여 개발자가 코드를 작성 및 실행하면서 보안을 검사합니다.

    앞선 포스팅에서 구성한 DevOps 파이프라인은 GitLab에 푸시하는 이벤트로 인해 실행되는데, Pre-Commit 단계는 푸시 이전에 수행되는 작업이기 때문에 DevSecOps 파이프라인에 추가할 도구는 없습니다.

    <br>

- **Commit 단계**   <a name="list1_3"></a>

    다음으로 코드를 컴파일하고 빌드하는 과정에서 정적 분석을 수행해야 하는 Commit 단계입니다.

    [그림 2]는 SANS 연구소에서 정리한 Commit 단계에서 사용할 수 있는 보안 도구들을 정리한 것입니다.

    | ![commit_security_tool](/static/assets/img/landing/project/devsecops_6_2.png){: width="714" height="308"} |
    |:--:| 
    | [그림 2] Commit 단계의 보안 도구 |

    <br>

    Commit 단계는 빌드하고 테스트하는 과정에서 파이프라인의 보안 취약점을 찾기 위해 소스 코드 파일들을 스캔합니다.
    
    검사할 소스 코드의 언어에 따라 사용되는 도구들은 달라질 수 있습니다.

    본 프로젝트에서는 Java 기반의 웹 서비스에 보안을 적용해볼 것이고, 정적 분석에 사용할 도구들은 다음과 같습니다.

    1. OWASP Dependency Check
    
        프로젝트의 종속성을 검사하고, 공개적으로 공개 된 취약점을 탐지하는 소프트웨어 구성 분석 도구입니다.
        
        지정된 종속성에 대한 CPE(Common Platform Enumeration) 식별자가 있는지를 확인하고, 발견되면 관련 CVE 항목에 연결되는 보고서를 생성해줍니다.

        Jenkins와 Maven 플러그인이 존재하여 연동하기 쉽습니다.

    2. SpotBugs

        정적 분석 도구로 사용되는 FindBugs가 이제는 SpotBugs로 바뀌어 사용되고 있습니다.
        
        > 관련 내용은 [FindBugs README](https://github.com/findbugsproject/findbugs/blob/master/README.md)에서 확인할 수 있습니다. 
        
        제한된 룰셋(Rule Set)으로 정적 분석을 수행하여 결함을 확인하고 생성된 보고서를 확인할 수 있습니다.

    3. CheckStyle

        코딩 스타일 규칙을 정의하여 체크해줌으로써 코딩 스타일 통일할 수 있도록 도와줍니다. 

        프로젝트 완료 후 유지보수할 떄 생겨나는 많은 문제중 하나가 많은 프로그래머들이 각자의 취향에 따라 변수명, 메소드명, 작성법등이 다르기 때문에 문제가 발생할 수 있는데 이러한 문제를 해결하기 위해 만들어졌습니다.

        [그림 2]에 보이는 SANS 연구소의 자료에는 CheckStyle이 없지만 SpotBugs와 더불어 PMD와도 같이 정적 분석 도구로 많이 쓰이고 있어 사용해보았습니다.

    4. PMD(Programing Mistake Detector)

        SpotBugs와 마찬가지로 응용 프로그램에서 Java 소스를 정적 분석하여 발견된 문제를 보고해줍니다.
        
        문법적으로 오류 가능성이 높은 항목들을 체크해서 알려줍니다.

    5. SonarQube

    6. Anchore

    <br>

---

## <span style="color:purple">**2. SAST(Static Application Security Testing) 적용**</span>   <a name="list2"></a>

<br>

- **OWASP Dependency Check**   <a name="list2_1"></a>

    <br>

- **SpotBugs**   <a name="list2_2"></a>

    <br>

- **CheckStyle**   <a name="list2_3"></a>

    <br>

- **PMD(Programing Mistake Detector)**   <a name="list2_4"></a>

    <br>

- **SonarQube**   <a name="list2_5"></a>

    <br>

- **Anchore**   <a name="list2_6"></a>
    
    <br>
 