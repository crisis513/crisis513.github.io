---
layout: post
title: "[Review] 엑셀을 활용한 날짜 데이터 가공"
date: 2022-09-08
desc: "[Review] 엑셀을 활용한 데이터 가공"
keywords: "son,blog,review,date,data,processing,excel"
categories: [Review]
tags: [son,blog,review,date,data,processing,excel]
icon: icon-html
---

## 목차

[1. 개요](#list1)

[2. 데이터 가공 방법](#list2)

---

## <span style="color:purple">**1. 개요**</span>   <a name="list1"></a>

필자가 군대에서 데이터를 시각화하는 업무를 보던 중 지원과에서 전달받은 엑셀 데이터의 날짜 형식이 중구난방이었던 적이 있었습니다. [그림 1]과 같이 어떤 셀에는 텍스트형식, 어떤 셀에는 날짜형식, 어떤 셀에는 숫자형식으로 되어 있는 총체적 난국의 데이터였습니다. 

<br>

| ![date_pic_1](/static/assets/img/landing/project/date1.png) |
|:--:| 
| [그림 1] 전달받은 엑셀의 날짜 데이터 예시 |

<br>

원래는 엑셀로 양식을 만들어 담당자들에게 뿌려서 취합하여 만든 데이터였는데, 날짜 형식을 지정해주지 않아 각양각색의 날짜 포맷으로 온 것으로 보입니다. **다른 포맷의 날짜 형식을 하나의 포맷으로 통일시켜 정상적으로 데이터 시각화시켜줄 수 있도록 가공하는 것이 본 포스팅에서의 목적**이다. 파이썬으로도 가공할 수 있겠지만, 여기서는 엑셀에서 가공하는 방법을 설명할 것 입니다. 

<br>

## <span style="color:purple">**2. 데이터 가공 방법**</span> <a name="list2"></a>

사실 필자는 엑셀을 다뤄본 경험은 없지만 Qlik Sense라는 데이터 분석 툴에서 표현식을 많이 작성하다보니 엑셀의 함수가 매우 익숙했습니다. 우선 [그림 1]의 날짜 데이터 모든 셀의 표시 형식을 통일을 시키는 것을 시작으로 아래 10 단계의 과정을 거쳐 데이터를 가공하였습니다. `A열은 개판 5분 전인 날짜 데이터`이고, **B열부터는 다음 설명의 3번부터 함수를 적용시켜 단계적으로 가공해나갈 것** 입니다. 

1. 값 및 숫자 서식 붙여넣기
    
    우선 날짜 형식을 깨지 않으면서 셀 서식을 모두 텍스트로 형식으로 동일하게 맞춰줘야 했습니다. 따라서 날짜 데이터 열(A열) 전체를 선택하여 [텍스트 나누기] - [구분 기호로 분리됨] - [탭] - [텍스트] 순서로 클릭해나가면 날짜 형식이 숫자로 변환되지 않고 텍스트 그대로 남아있습니다.

2. 찾기 및 바꾸기: **'-' → '.', '월' → '.', '일' → '.'**

    텍스트로 된 날짜 포맷에서 년월일 날짜 구분자를 '.'으로 하기위해 A열 모든 셀들의 '-', '월', '일'이라고 표기를 찾아 '.'으로 모두 바꾸기 합니다. Ctrl + F 단축키를 누르면 [그림 2]와 같이 찾기 및 바꾸기 창이 뜨는데 바꾸기 탭에서 모두 찾기 및 모두 바꾸기 하면 됩니다.

    | ![date_pic_2](/static/assets/img/landing/project/date2.png) |
    |:--:| 
    | [그림 2] 찾기 및 모두 바꾸기 |

    <br>

3. B1셀 수식: **=IF(RIGHT(A1,1)=".",LEFT(A1,LEN(A1)-1),A1)**

    A1열의 맨 오른쪽 첫 문자가 '.'이라면 삭제하고, A열에 입력되어 있는 행까지 수식 채워넣기 한다. [그림 3]과 같이 되는 것을 확인할 수 있습니다.

    | ![date_pic_3](/static/assets/img/landing/project/date3.png) |
    |:--:| 
    | [그림 3] B열에서 A열 날짜 데이터 가공 예시 |

    <br>

4. C1셀 수식: **=IF(LEFT(B1,5)="2021.",RIGHT(B1,LEN(B1)-5),B1)**

    B1열의 맨 왼쪽 다섯 문자가 '2021.'이라면 삭제하고, A열에 입력되어 있는 행까지 수식 채워넣기 합니다. 

5. D1셀 수식: **=IF(LEFT(C1,3)="21.",RIGHT(C1,LEN(C1)-3),C1)**

    C1열의 맨 왼쪽 세 문자가 '21.'이라면 삭제하고, A열에 입력되어 있는 행까지 수식 채워넣기 합니다.

6. E1셀 수식: **=IF(LEFT(D1,1)<>"0",CONCATENATE("0",D1),D1)**

    D1열의 맨 왼쪽 첫 문자가 '0'이 아니라면 T열의 문자 앞에 '0'을 붙이고, A열에 입력되어 있는 행까지 수식 채워넣기 합니다.

7. F1셀 수식: **=IF(LEFT(E1,3)="010",RIGHT(E1,LEN(E1)-1),E1)**

    E1열의 맨 왼쪽 세 문자가 '010'이라면 우측의 두 문자만 선택하고, A열에 입력되어 있는 행까지 수식 채워넣기 합니다.

8. G1셀 수식: **=IF(LEFT(F1,3)="011",RIGHT(F1,LEN(F1)-1),IF(LEFT(F1,3)="012",RIGHT(F1,LEN(F1)-1),F1))**

    F1열의 맨 왼쪽 세 문자가 '011'이라면 우측의 두 문자만 선택하고, '012'이어도 우측의 두 문자만 선택합니다. 그리고 A열에 입력되어 있는 행까지 수식 채워넣기 합니다.

9. H1셀 수식: **=IF(LEN(G1)=4,LEFT(G1,3)&"0"&RIGHT(G1,1),G1)**

    G1열의 길이가 4라면 G1의 우측 세 문자 뒤에 '0'을 붙이고, 그 뒤에 G1열의 맨 우측 한 문자를 붙입니다. 그리고 A열에 입력되어 있는 행까지 수식 채워넣기 합니다.

10. I1셀 수식: **=CONCATENATE("2021.",H1)**

    H1열의 맨 앞에 '2021.'을 붙이고, A열에 입력되어 있는 행까지 수식 채워넣기 합니다. 10번까지 정상적으로 입력했다면 다음 [그림 4]와 같이 나올 것 입니다.

    | ![date_pic_4](/static/assets/img/landing/project/date4.png) |
    |:--:| 
    | [그림 4] 단계별 데이터 가공 예시 |

    <br>

본 포스팅에서는 모든 년도가 2021년 데이터이기 때문에 년도에 해당하는 부분을 모두 지우고 2021로 가공했지만, 필요에 따라 년도 부분은 건들이지 않거나 년도의 자릿수를 맞춰주기 위해 맨 앞에 '20'을 붙여주는 등 상황에 맞는 수식을 작성해주면 될 것 같습니다.